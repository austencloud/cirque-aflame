<!-- src/lib/components/agents/[id]/+page.svelte -->
<script lang="ts"> import { agents } from '$lib/state/agents.svelte';
	import Icon from '$lib/components/ui/Icon.svelte';
	import Button from '$lib/components/ui/Button.svelte';
	import LoadingSpinner from '$lib/components/ui/LoadingSpinner.svelte';
	import { format } from 'date-fns';

	const { agentId } = $props<{ agentId: string }>();
	// State
	let loading = $state(true);
	// Load agent $effect(() => { async function loadData() { try { await agents.loadAgent(agentId); } catch (error) { console.error('Error loading agent:', error); } finally { loading = false; } } loadData(); });

	const agent = $derived(agents.selectedAgent);
</script>

<div class="sm: lg:"> {#if loading} <div > <LoadingSpinner size="lg" /> </div> {:else if !agent} <div > <Icon name="briefcase" size={48} extraClass="mx-auto text-gray-400 mb-4" /> <h3 >Agent not found</h3> <p >The agent you're looking for doesn't exist.</p> <Button onclick={() => (window.location.href = '/agents')}> {#snippet children()} <Icon name="arrow-left" size={18} extraClass="mr-1" /> Back to Agents {/snippet} </Button> </div> {:else} <!-- Header --> <div > <div > <Button onclick={() => (window.location.href = '/agents')} variant="outline"> {#snippet children()} <Icon name="arrow-left" size={18} extraClass="mr-1" /> Back {/snippet} </Button> <h1 >{agent.name}</h1> </div> <Button onclick={() => alert('Edit functionality coming soon!')}> {#snippet children()} <Icon name="edit" size={18} extraClass="mr-1" /> Edit {/snippet} </Button> </div> <!-- Agent Details --> <div class="-cols-1"> <!-- Main Info --> <div class="lg:"> <!-- Contact Information --> <div class="bg-white"> <h2 >Contact Information</h2> <dl class="-cols-1"> <div> <dt >Agency</dt> <dd >{agent.agency}</dd> </div> <div> <dt >Email</dt> <dd > <a href="mailto:{agent.email}" > {agent.email} </a> </dd> </div> <div> <dt >Phone</dt> <dd > <a href="tel:{agent.phone}" > {agent.phone} </a> </dd> </div> <div> <dt >Preferred Contact</dt> <dd >{agent.preferredContactMethod}</dd> </div> </dl> </div> <!-- Partnership Details --> <div class="bg-white"> <h2 >Partnership Details</h2> <dl class="-cols-1"> {#if agent.partnershipStartDate} <div> <dt >Partnership Start</dt> <dd > {format(new Date(agent.partnershipStartDate), 'MMM d, yyyy')} </dd> </div> {/if} <div> <dt >Payment Terms</dt> <dd >{agent.paymentTerms}</dd> </div> {#if agent.commissionRate} <div> <dt >Commission Rate</dt> <dd >{agent.commissionRate}%</dd> </div> {/if} </dl> </div> <!-- Specializations --> {#if agent.specialization && agent.specialization.length > 0} <div class="bg-white"> <h2 >Specializations</h2> <div class="-wrap"> {#each agent.specialization as spec} <span class="-" > {spec} </span> {/each} </div> </div> {/if} <!-- Notes --> {#if agent.notes} <div class="bg-white"> <h2 >Notes</h2> <p class="-wrap">{agent.notes}</p> </div> {/if} </div> <!-- Sidebar --> <div > <!-- Opportunities Sent --> <div class="bg-white"> <h2 >Opportunities Sent</h2> {#if agent.opportunitiesSent && agent.opportunitiesSent.length > 0} <ul > {#each agent.opportunitiesSent as opportunity} <li class="-l-4"> <p >{opportunity.description}</p> <p > {format(new Date(opportunity.date), 'MMM d, yyyy')} </p> <span class="{opportunity.status === 'accepted' ? ' ' : opportunity.status === 'rejected' ? ' ' : ' '}" > {opportunity.status} </span> {#if opportunity.value} <p > ${opportunity.value.toLocaleString()} </p> {/if} </li> {/each} </ul> {:else} <p >No opportunities sent yet</p> {/if} </div> <!-- Metadata --> <div class="bg-white"> <h2 >Metadata</h2> <dl > <div> <dt >Created</dt> <dd > {format(new Date(agent.createdAt), 'MMM d, yyyy')} </dd> </div> <div> <dt >Last Updated</dt> <dd > {format(new Date(agent.updatedAt), 'MMM d, yyyy')} </dd> </div> </dl> </div> </div> </div> {/if}
</div> 